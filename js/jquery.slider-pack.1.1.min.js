/*
 * Two Dimensional Slider for Touchfolio theme.
 *
 * Copyright 2012 Dmitry Semenov. http://dimsemenov.com
 *
 * You must not use this slider outside the Touchfolio theme. Slider is based on commercial RoyalSlider script.
 *
*/
(function(b){function a(f,g){var x=navigator.userAgent.toLowerCase(),q=this,D=jQuery.browser,l=D.mozilla,u,n=D.webkit,j=x.match(/(iphone|ipod|ipad)/),C=x.indexOf("android")>-1,c=x.indexOf("chrome")>-1,k=(navigator.appVersion.indexOf("Mac")!=-1);var E=document.createElement("div").style,v=["webkit","Moz","ms","O"],B="",h;for(i=0;i<v.length;i++){h=v[i];if(!B&&(h+"Transform") in E){B=h}h=h.toLowerCase()}q._isChrome=c;q._wpVars=tdSliderVars;q.sliderRoot=b(f);q._slidesWrapper=q.sliderRoot.find(".slider-wrapper");q._loopItems=false;q._loopAlbums=false;q.onTransitionStart=function(){};q.onTransitionComplete=function(){};q._startTime;q._moveDist;q._accelerationX;q._accelerationY;q._currAnimSpeed;q._isVerticalNav=false;q._currMoveAxis="none";q._collapsedSlider=false;q._isAnimating=false;q._isDragging=false;q._multipleTouches=false;q.moved;q.startX;q.startY;q.pointX;q.pointY;q.changedX;q.changedY;q.firstLoaded=false;q.directionLocked;q.x=0;q.y=0;q.loadingTimeout;q.settings=b.extend({},b.fn.twoDimSlider.defaults,g);q._useCSS3Transitions=q._use3dTransform=!c?Modernizr.csstransforms3d:false;q._orientationChangeEvent="onorientationchange" in window?"orientationchange.tds resize.tds":"resize.tds";if(window.navigator.msPointerEnabled){if("ontouchstart" in window||"createTouch" in document){q.hasTouch=false}q._downEvent="MSPointerDown.tds";q._moveEvent="MSPointerMove.tds";q._upEvent="MSPointerUp.tds ";q._cancelEvent=q._upEvent;q._clickEvent=q._downEvent}else{if("ontouchstart" in window||"createTouch" in document){q.hasTouch=true;q._downEvent="touchstart.tds";q._moveEvent="touchmove.tds";q._upEvent="touchend.tds ";q._cancelEvent="touchcancel.tds";q._clickEvent="touchstart"}else{q.hasTouch=false;q._grabCursor;q._grabbingCursor;var x=b.browser;if(x.msie||x.opera){q._grabCursor=q._grabbingCursor="move"}else{if(x.mozilla){q._grabCursor="-moz-grab";q._grabbingCursor="-moz-grabbing"}else{if(k&&n){q._grabCursor="-webkit-grab";q._grabbingCursor="-webkit-grabbing"}else{}}}this._setGrabCursor();q._downEvent="mousedown.tds";q._moveEvent="mousemove.tds";q._upEvent="mouseup.tds";q._cancelEvent="mouseup.tds";q._clickEvent="click"}}if(!q.hasTouch){q._arrowControlsEnabled=true;q._fastClick="click"}else{q._arrowControlsEnabled=true;q._fastClick="touchstart"}var w='<div class="slider-wrapper"><div class="drag-container">',o=["center","top","right","bottom","left"];b.each(o,function(){w+='<div class="block '+this+'"><div class="block-inside"></div></div>'});w+="</div></div>";w+='<div class="video-overlay"><div class=" video-close-button"><a href="javascript:void();" class="hidden-video underlined">'+q._wpVars.closeVideo+'</a></div><div class="video-container"></div></div>';if(q._arrowControlsEnabled){}w+='<div class="slider-controls">';if(q._arrowControlsEnabled){w+='<div class="arrow-left disabled-arrow"><a  href="javascript:void(0);" class="icon-bg"><span class="icon"></span><span class="info-text">'+(q._wpVars.prevAlbum)+'</span></a></div><div class="arrow-right"><a href="javascript:void(0);" class="icon-bg"><span class="icon"></span><span class="info-text">'+(q._wpVars.nextAlbum)+"</span></a></div>"}var z=q._getQueryParameters().listurl;if(z){w+='<div class="back-to-list-button"><a class="close-gallery-button underlined" href="'+z+'">'+q._wpVars.backToList+"</a></div>"}w+='<div class="slider-album-indicator">';w+='<div class="album-info-text"><a href="javascript:void(0);" title="Info" class="album-name-indicator underlined"></a><span class="item-count-indicator"></span></div>';w+="</div>";w+="</div>";q._galleryPostsNavigation=q.sliderRoot.find(".gallery-posts-navigation");q._lastItemLink=false;if(q._galleryPostsNavigation.length>0){q._lastItemLink=true}q.sliderRoot.append(w);q._slidesWrapper=q.sliderRoot.find(".slider-wrapper");q.videoOverlay=q.sliderRoot.find(".video-overlay");q.videoContainer=q.videoOverlay.find(".video-container");q.currVideoImg="";q.isVideoPlaying=false;q._videoCloseButton=q.videoOverlay.find(".video-close-button");q._videoCloseButton.bind("click",function(F){q.stopAndCloseVideo()});q._nextPrevActionsLocked=false;var A=q._slidesWrapper;q._dragContainer=A.find(".drag-container");q._topBlock=A.find(".top");q._leftBlock=A.find(".left");q._centerBlock=A.find(".center");q._rightBlock=A.find(".right");q._bottomBlock=A.find(".bottom");q._albumInfoAnimating=false;q.loadQueue;q.imageLoader;q._lastAlbumId;q._lastAlbumNumItems;q._lastItemId;q._changeHash=false;q._imagePaddingEMs=0;q._controlsVisible=true;q._currentMainBlockId=0;q._currentMainAlbumBlockId=0;q._tempMainBlockId=0;q._tempMainAlbumBlockId=0;if(q.settings.disableContextMenu){q.sliderRoot.bind("contextmenu",function(F){F.preventDefault();F.stopImmediatePropagation();return false})}if(q.hasTouch){q._lastItemFriction=0.5;q.settings.autoOpenDescription=false}else{q._lastItemFriction=0.2}if(q._useCSS3Transitions){if(l&&B==="moz"){q.browserSufix="-moz-";q._yProp=q._xProp="-moz-transform";q.transitionEndEvent="transitionend.tds";if(q._use3dTransform){q._tPref1="translate3d(";q._tPref2="px, ";q._tPref3="px, 0px)"}else{q._tPref1="translate(";q._tPref2="px, ";q._tPref3="px)"}}else{if(n&&q._use3dTransform){q.browserSufix="-webkit-";q._yProp=q._xProp="-webkit-transform";q.transitionEndEvent="webkitTransitionEnd.tds";if(q._use3dTransform){if(!c){q._dragContainer.children().css({"-webkit-transform":"translateZ(0)","-webkit-perspective":"1000","-webkit-backface-visibility":"hidden"})}q._dragContainer.css({"-webkit-transform":"translateZ(0px)","-webkit-perspective":"1000","-webkit-backface-visibility":"hidden"});q._tPref1="translate3d(";q._tPref2="px, ";q._tPref3="px, 0px)"}else{q._tPref1="translate(";q._tPref2="px, ";q._tPref3="px)"}}else{q.browserSufix=(/trident/i).test(navigator.userAgent)?"-ms-":"opera" in window?"-o-":"";q._yProp=q._xProp=q.browserSufix+"transform";q.transitionEndEvent=q.browserSufix+"transitionend.tds";q._tPref1="translate(";q._tPref2="px, ";q._tPref3="px)"}}}else{q._xProp="left";q._yProp="top";q._tPref1="";q._tPref2="";q._tPref3="";q._tPref4=""}q._sliderControls=q.sliderRoot.find(".slider-controls");q._albumInfoOpen=false;q._albumInfoAnimRunning=false;q._headerSideMenu=b(".main-header");q._menusContainer=q._headerSideMenu.find(".menus-container");q._menusContainer=q._headerSideMenu.find(".menus-container");q.albumsArr=[];q.currAlbum;q._albumIndicator=q._sliderControls.find(".slider-album-indicator");q._albumInfoText=q._albumIndicator.find(".album-info-text");q._albumNameIndicator=q._albumIndicator.find(".album-name-indicator");q._itemCountIndicator=q._albumIndicator.find(".item-count-indicator");q._albumInfoBlock=b('<div class="album-info-block text-block"><div class="album-info-text"></div></div>').appendTo("body");var y;q._albumIndicator.bind("click",function(){q._toggleAlbumInfo()});if(q.settings.appendGalleriesToMenu){var m=q.sliderRoot.find(".two-dim-album"),t,s='<ul id="gallery-menu" class="menu">',r;m.each(function(F,G){t=b(G).data("start-item",0);r=t.attr("data-album-id");s+='<li data-id="'+r+'" class="menu-item"><a href="#'+r+'">'+t.find(".album-title").text()+"</a></li>";q.albumsArr.push(t)});s+="</ul>"}else{q.sliderRoot.find(".two-dim-album").each(function(F,G){q.albumsArr.push(b(G).data("start-item",0))})}if(!q.albumsArr.length>0){alert("Gallery error :(. No albums and images found");return}var p=0;var d=window.location.hash;if(d){d=d.replace(/^#/,"");p=q.getAlbumIdByIdAtt(d)}q.currAlbum=q.albumsArr[p];q.currAlbumId=p;q.numAlbums=q.albumsArr.length;if(q._arrowControlsEnabled){q._prevImageArr=q.sliderRoot.find(".arrow-left").click(function(F){F.preventDefault();q.prev()});q._nextImageArr=q.sliderRoot.find(".arrow-right").click(function(F){F.preventDefault();q.next()})}q._primaryMenu=q._headerSideMenu.find(".primary-menu > .current-menu-item");if(q.settings.appendGalleriesToMenu&&q.numAlbums>1){if(q._primaryMenu.index()!=0){q._primaryMenu.before('<span class="menu-sep project-menu-sep">&mdash;</span>')}s+='<span class="menu-sep project-menu-sep">&mdash;</span>';q._primaryMenu.append(s);q._galleryMenuItems=q._primaryMenu.find("#gallery-menu").find("li");q._galleryMenuItems.click(function(F){F.preventDefault();F.stopImmediatePropagation();var G=q.getAlbumIdByIdAtt(b(this).attr("data-id"));q._moveTo(G,"y",500,true,true)})}q.currAlbumItems=q.currAlbum.find(".two-dim-item");q.currItemId=0;q.currAlbumNumItems=q.currAlbumItems.length;q.currAlbumScaleMode=q.currAlbum.data("img-scale");var e;b(window).bind(q._orientationChangeEvent,function(){if(e){clearTimeout(e)}e=setTimeout(function(){q.updateSliderSize()},35)});q.updateSliderSize();q.updateContents();q._slidesWrapper.bind(q._downEvent,function(F){q._onDragStart(F)});if(q.settings.keyboardNavEnabled){b(document).keydown(function(F){if(!q._isDragging&&!q._isAnimating){if(F.keyCode===37){F.preventDefault();q.prev()}else{if(F.keyCode===39){F.preventDefault();q.next()}else{if(F.keyCode===40){F.preventDefault();q.nextAlbum()}else{if(F.keyCode===38){F.preventDefault();q.prevAlbum()}else{if(F.keyCode===73){q._toggleAlbumInfo()}}}}}}})}b("body").bind("mouseleave",function(F){if(q._isDragging){q._onDragRelease(F)}});if(!q.hasTouch){q.sliderRoot.bind("mousewheel",function(H,I,G,F){if(I<0){q.next()}else{if(I>0){q.prev()}}})}q._changedByHash=false;q._ignoreHashChange=false;q._hashTimeout;q._unblockHashChange();if(q.hasTouch){b.idleTimer(q.hasTouch?4000:2000,document,{events:"mousemove touchend mouseup"});b(document).bind("idle.idleTimer",function(){if(!q._albumInfoOpen){q._hideAllControls()}})}else{}if(q.settings.autoOpenDescription){if(q.sliderWidth>900){q._showAlbumInfo();q._fadeOut(q._albumIndicator);q.albumsArr[q.currAlbumId].data("sawInfo",true)}}}a.prototype={getAlbumIdByIdAtt:function(f){var c=this,d=c.albumsArr;for(var e=0;e<d.length;e++){if(d[e].attr("data-album-id")===f){return e}}return 0},_blockHashChange:function(){b(window).unbind("hashchange.tds")},_updateAlbumHash:function(){var c=this;c._updateHash(c.albumsArr[c.currAlbumId].attr("data-album-id"))},_unblockHashChange:function(){var c=this;b(window).bind("hashchange.tds",function(f){var d=location.hash;d=d.replace(/^#/,"");var g=c.getAlbumIdByIdAtt(d);c._moveTo(g,"y",500)})},_updateHash:function(d){var c=this;c._blockHashChange();window.location.hash=d;if(c._hashTimeout){clearTimeout(c._hashTimeout)}c._hashTimeout=setTimeout(function(){c._unblockHashChange()},60)},_doBackAndForthAnim:function(f){var k=this,g,c,j,l=Math.max(k._xDistToSnap,130)/3;k._currAnimSpeed=200;function d(){k._isAnimating=false}function e(){k._isAnimating=false;k._animateTo(g,"",c,false,true,d)}if(f==="bottom"){g=k._tempMainAlbumBlockId*k.sliderHeight;c="y";j=-l}else{if(f==="top"){g=k._tempMainAlbumBlockId*k.sliderHeight;c="y";j=l}else{if(f==="right"){g=k._tempMainBlockId*k.sliderWidth;c="x";j=-l}else{if(f==="left"){g=k._tempMainBlockId*k.sliderWidth;c="x";j=l}}}}if(k._lastItemLink){var h;if(f==="left"||f==="top"){h=k._galleryPostsNavigation.find("a[rel=next]").attr("href")}else{h=k._galleryPostsNavigation.find("a[rel=prev]").attr("href")}if(h){window.location.href=h;return}}k._animateTo(g+j,"",c,false,true,e)},_moveTo:function(l,f,e,j,h,c){var o=this,g,k,d;if(o._isDragging||o._isAnimating){return false}if(o.isVideoPlaying){o.stopAndCloseVideo()}if(f==="y"&&j){o._changeHash=true}else{o._changeHash=false}if(f==="x"){if(l==="next"){if(!o._loopItems&&o.currItemId+1>=o.currAlbumNumItems){o._doBackAndForthAnim("right");return false}o._hideAlbumInfo();o._tempMainBlockId=o._currentMainBlockId-1;o._updateCurrItemId(o.currAlbumId,o.currItemId+1);g=o._rightBlock;o._rightBlock=o._leftBlock;o._leftBlock=o._centerBlock;o._centerBlock=g;k=o._tempMainBlockId*o.sliderWidth;o._currAnimSpeed=e;o._animateTo(k,"next","x",false,h)}else{if(l==="prev"){if(!o._loopItems&&o.currItemId-1<0){o._doBackAndForthAnim("left");return false}o._hideAlbumInfo();o._tempMainBlockId=o._currentMainBlockId+1;o._updateCurrItemId(o.currAlbumId,o.currItemId-1);g=o._centerBlock;o._centerBlock=o._leftBlock;o._leftBlock=o._rightBlock;o._rightBlock=g;k=o._tempMainBlockId*o.sliderWidth;o._currAnimSpeed=e;o._animateTo(k,"prev","x",false,h)}else{var n=parseInt(l,10);if(n===o.currItemId+1){o._moveTo("next","x",e)}else{if(n===o.currAlbumId-1){o._moveTo("prev","x",e)}else{if(n>o.currItemId){o._tempMainBlockId=o._currentMainBlockId-1;o._updateCurrItemId(o.currAlbumId,currItemId);g=o._rightBlock;o._rightBlock=o._leftBlock;o._leftBlock=o._centerBlock;o._centerBlock=g;k=o._tempMainBlockId*o.sliderWidth;o._currAnimSpeed=e;o._centerBlock.find("img").css("visibility","hidden");o._animateTo(k,"next","x",true,h)}else{if(n<o.currItemId){o._tempMainAlbumBlockId=o._currentMainAlbumBlockId+1;o._updateCurrItemId(o.currAlbumId,currItemId);g=o._centerBlock;o._centerBlock=o._leftBlock;o._leftBlock=o._rightBlock;o._rightBlock=g;k=o._tempMainAlbumBlockId*o.sliderHeight;o._currAnimSpeed=e;o._centerBlock.find("img").css("visibility","hidden");o._animateTo(k,"prev","x",true,h)}}}}}}}else{if(l==="next"){if(!o._loopAlbums&&o.currAlbumId+1>=o.numAlbums){if(!c){o._doBackAndForthAnim("bottom")}else{o._doBackAndForthAnim("right")}return false}o._hideAlbumInfo();o._tempMainAlbumBlockId=o._currentMainAlbumBlockId-1;o._updateCurrItemId(o.currAlbumId+1,0);d=o._getAlbum(o.currAlbumId);o.currItemId=d.data("start-item");g=o._bottomBlock;o._bottomBlock=o._topBlock;o._topBlock=o._centerBlock;o._centerBlock=g;k=o._tempMainAlbumBlockId*o.sliderHeight;o._currAnimSpeed=e;o._animateTo(k,"next","y",false,h)}else{if(l==="prev"){if(!o._loopAlbums&&o.currAlbumId-1<0){if(!c){o._doBackAndForthAnim("top")}else{o._doBackAndForthAnim("left")}return false}o._hideAlbumInfo();o._tempMainAlbumBlockId=o._currentMainAlbumBlockId+1;o._updateCurrItemId(o.currAlbumId-1,0);d=o._getAlbum(o.currAlbumId);o.currItemId=d.data("start-item");g=o._centerBlock;o._centerBlock=o._topBlock;o._topBlock=o._bottomBlock;o._bottomBlock=g;k=o._tempMainAlbumBlockId*o.sliderHeight;o._currAnimSpeed=e;o._animateTo(k,"prev","y",false,h)}else{var m=parseInt(l,10);if(m===o.currAlbumId+1){o._moveTo("next","y",e,j,h)}else{if(m===o.currAlbumId-1){o._moveTo("prev","y",e,j,h)}else{if(m>o.currAlbumId){o._tempMainAlbumBlockId=o._currentMainAlbumBlockId-1;o._updateCurrItemId(m,0);d=o._getAlbum(o.currAlbumId);o.currItemId=d.data("start-item");g=o._bottomBlock;o._bottomBlock=o._topBlock;o._topBlock=o._centerBlock;o._centerBlock=g;k=o._tempMainAlbumBlockId*o.sliderHeight;o._currAnimSpeed=e;o._updateAlbumBackground(o._centerBlock,d.data("bg"),o.currAlbumId);o._centerBlock.find(".play-button-container").remove();o._centerBlock.find("img").css("visibility","hidden");o._animateTo(k,"next","y",true,h)}else{if(m<o.currAlbumId){o._tempMainAlbumBlockId=o._currentMainAlbumBlockId+1;o._updateCurrItemId(m,0);d=o._getAlbum(o.currAlbumId);o.currItemId=d.data("start-item");g=o._centerBlock;o._centerBlock=o._topBlock;o._topBlock=o._bottomBlock;o._bottomBlock=g;k=o._tempMainAlbumBlockId*o.sliderHeight;o._currAnimSpeed=e;o._updateAlbumBackground(o._centerBlock,d.data("bg"),o.currAlbumId);o._centerBlock.find(".play-button-container").remove();o._centerBlock.find("img").css("visibility","hidden");o._animateTo(k,"prev","y",true,h)}}}}}}}o._updateControls(f)},next:function(){var c=this;if(!c._nextPrevActionsLocked){c._nextPrevActionsLocked=true;if(c.currItemId+1>=c.currAlbumNumItems&&c.currAlbumId<c.numAlbums-1){c._moveTo("next","y",this.settings.transitionSpeed,true,true)}else{c._moveTo("next","x",this.settings.transitionSpeed,true,true)}c._nextPrevActionsLocked=false}},prev:function(){var c=this;if(!c._nextPrevActionsLocked){c._nextPrevActionsLocked=true;if(!c._loopItems&&c.currItemId-1<0&&c.currAlbumId!=0){c._moveTo("prev","y",this.settings.transitionSpeed,true,true)}else{c._moveTo("prev","x",this.settings.transitionSpeed,true,true)}c._nextPrevActionsLocked=false}},nextItem:function(){this._moveTo("next","x",this.settings.transitionSpeed,true,true)},prevItem:function(){this._moveTo("prev","x",this.settings.transitionSpeed,true,true)},nextAlbum:function(){this._moveTo("next","y",this.settings.transitionSpeed,true,true)},prevAlbum:function(){this._moveTo("prev","y",this.settings.transitionSpeed,true,true)},_updateAlbumBackground:function(e,d,c){if(e.data("bg-album-id")!==c){e.data("bg-album-id",c);e.css("background",d)}},_onDragStart:function(g){var d=this;if(d._isAnimating){g.preventDefault();return false}if(d._isDragging){if(d.hasTouch){d._multipleTouches=true}return}else{if(d.hasTouch){d._multipleTouches=false}}if(d._useCSS3Transitions){d._dragContainer.css((d.browserSufix+"transition-duration"),"0s")}d._setGrabbingCursor();d._isDragging=true;var c;if(d.hasTouch){var f=g.originalEvent.touches;if(f&&f.length>0){c=f[0];if(f.length>1){d._multipleTouches=true}}else{return false}}else{c=g;g.preventDefault()}b(document).bind(d._moveEvent,function(h){d._onDragMove(h)});b(document).bind(d._upEvent,function(h){d._onDragRelease(h)});d._isVerticalNav=false;d._currMoveAxis="";d.moved=false;d.pointX=d._accelerationX=d.startX=c.pageX;d.pointY=d._accelerationY=d.startY=c.pageY;d.changedX=0;d.changedY=0;d.horDirection=0;d.verDirection=0;d.directionLocked=false;d._startTime=(g.timeStamp||(new Date().getTime()));d._moveDist=0;if(d.hasTouch){d._slidesWrapper.bind(d._cancelEvent,function(h){d._onDragRelease(h)})}},_onDragMove:function(k){var m=this,l;if(m.hasTouch){var j=k.originalEvent.touches;if(j){if(j.length>1){return false}else{l=j[0]}}else{return false}k.preventDefault()}else{l=k;k.preventDefault()}var g=(k.timeStamp||(new Date().getTime())),h=l.pageX-m.pointX,f=l.pageY-m.pointY;m.changedX+=Math.abs(h);m.changedY+=Math.abs(f);if(m.changedY<10&&m.changedX<7){return}var c=m.x+h,n=m.y+f;m.moved=true;m.pointX=l.pageX;m.pointY=l.pageY;var d=m._currMoveAxis;if(d==="x"){if(h!==0){m.horDirection=h>0?1:-1}}else{if(d==="y"){if(f!==0){m.verDirection=f>0?1:-1}}else{if(m.changedY>m.changedX){m._isVerticalNav=true;m._currMoveAxis="y";m.verDirection=f>0?1:-1}else{m._currMoveAxis="x";m.horDirection=h>0?1:-1}}}if(m._isVerticalNav){if(!m._loopAlbums){if(m.currAlbumId<=0){if(l.pageY-this.startY>0){n=m.y+f*m._lastItemFriction}}if(m.currAlbumId>=m.numAlbums-1){if(l.pageY-this.startY<0){n=m.y+f*m._lastItemFriction}}}m._setPosition(n,"y");if(g-m._startTime>200){m._startTime=g;m._accelerationY=l.pageY}}else{if(!m._loopItems){if(m.currItemId<=0){if(l.pageX-this.startX>0){c=m.x+h*m._lastItemFriction}}if(m.currItemId>=m.currAlbumNumItems-1){if(l.pageX-this.startX<0){c=m.x+h*m._lastItemFriction}}}m._setPosition(c,"x");if(g-m._startTime>200){m._startTime=g;m._accelerationX=l.pageX}}return false},_onDragRelease:function(C){var w=this,y=w.hasTouch?C.originalEvent.changedTouches[0]:C,p,s,B,c,k,j,h,m,g;w._isDragging=false;b(document).unbind(w._moveEvent);b(document).unbind(w._upEvent);if(w.hasTouch){w._slidesWrapper.unbind(w._cancelEvent)}w._setGrabCursor();if(!w.moved&&!w._multipleTouches){if(w._albumInfoOpen){w._hideAlbumInfo();return}if(w.hasTouch){if(w._controlsVisible){w._hideAllControls()}else{w._showAllControls()}return}else{if(!b(C.target).hasClass("play-button-icon")){w.next()}return}}c=Math.max(30,(C.timeStamp||(new Date().getTime())))-w._startTime;function f(e){if(e<200){return 200}else{if(e>500){return 500}}return e}function q(F,G,e){if(F==="x"){j=w._currentMainBlockId*w.sliderWidth}else{j=w._currentMainAlbumBlockId*w.sliderHeight}h=Math.abs(w[F]-j);w._currAnimSpeed=h/e;if(G){w._currAnimSpeed+=250}w._currAnimSpeed=f(w._currAnimSpeed);w._animateTo(j,false,F)}var l=0;if(w._isVerticalNav){var t="y",n=y.pageY,z=w.startY,o=w._accelerationY,A=w.currAlbumId,E=w.numAlbums,x=w.verDirection,r=w.sliderHeight,u=w._currentMainAlbumBlockId,D=w._loopAlbums,v=true,d=50}else{var t="x",n=y.pageX,z=w.startX,o=w._accelerationX,A=w.currItemId,E=w.currAlbumNumItems,x=w.horDirection,r=w.sliderWidth,u=w._currentMainBlockId,D=w._loopItems,v=false,d=0}p=n-z;s=Math.abs(p);B=n-o;k=(Math.abs(B))/c;if(x===0||E<=1){q(t,true,k);return false}if(!D){if(A<=0){if(x>0){q(t,true,k);return false}}else{if(A>=E-1){if(x<0){q(t,true,k);return false}}}}if(z+l<n){if(x<0){q(t,false,k);return false}w._moveTo("prev",t,f(Math.abs(w[t]-(u+1)*r)/k),v)}else{if(z-l>n){if(x>0){q(t,false,k);return false}w._moveTo("next",t,f(Math.abs(w[t]-(u-1)*r)/k),v)}else{q(t,false,k)}}return false},_addItemToLoadQueue:function(c,j,f,k){var e=this,h,d=e._getAlbum(f);if(k==="start-item"){k=d.data("start-item")}h=e._getItem(f,k);if(!h){j.addClass("last-block")}else{if(j.hasClass("last-block")){j.removeClass("last-block")}var g=h.data("img-scale");if(!g){g=d.data("img-scale");h.data("img-scale",g)}c.push({block:j,item:h,bgColor:d.data("bg"),albumId:f})}},_animateTo:function(l,f,e,c,k,g){var m=this,h;m.onTransitionStart.call(m);m._isAnimating=true;m[e]=l;if(e==="x"){h=m._xProp}else{h=m._yProp}function j(){var p,o=[],n;if(f){if(e==="x"){m._addItemToLoadQueue(o,m._centerBlock,m.currAlbumId,m.currItemId);m._currentMainBlockId=m._tempMainBlockId;if(f==="next"){m._rightBlock.css("left",(-m._currentMainBlockId*100+100)+"%");m._addItemToLoadQueue(o,m._rightBlock,m.currAlbumId,m.currItemId+1)}else{if(f==="prev"){m._leftBlock.css("left",(-m._currentMainBlockId*100-100)+"%");m._addItemToLoadQueue(o,m._leftBlock,m.currAlbumId,m.currItemId-1)}}m._topBlock.css("left",(-m._currentMainBlockId*100)+"%");m._bottomBlock.css("left",(-m._currentMainBlockId*100)+"%");n=m._getAlbum(m.currAlbumId);n.data("start-item",m.currItemId);m._addItemToLoadQueue(o,m._bottomBlock,m.currAlbumId+1,"start-item");m._addItemToLoadQueue(o,m._topBlock,m.currAlbumId-1,"start-item")}else{n=m._getAlbum(m.currAlbumId);m.currItemId=n.data("start-item");m._addItemToLoadQueue(o,m._centerBlock,m.currAlbumId,m.currItemId);m._addItemToLoadQueue(o,m._rightBlock,m.currAlbumId,m.currItemId+1);m._currentMainAlbumBlockId=m._tempMainAlbumBlockId;if(f==="next"){m._bottomBlock.css("top",(-m._currentMainAlbumBlockId*100+100)+"%");m._addItemToLoadQueue(o,m._bottomBlock,m.currAlbumId+1,"start-item");if(c){m._addItemToLoadQueue(o,m._topBlock,m.currAlbumId-1,"start-item")}}else{m._topBlock.css("top",(-m._currentMainAlbumBlockId*100-100)+"%");m._addItemToLoadQueue(o,m._topBlock,m.currAlbumId-1,"start-item");if(c){m._addItemToLoadQueue(o,m._bottomBlock,m.currAlbumId+1,"start-item")}}m._leftBlock.css("top",(-m._currentMainAlbumBlockId*100)+"%");m._rightBlock.css("top",(-m._currentMainAlbumBlockId*100)+"%");m._addItemToLoadQueue(o,m._leftBlock,m.currAlbumId,m.currItemId-1)}m._updateImageQueue(o)}if(m._changeHash){m._updateAlbumHash()}setTimeout(function(){m._isAnimating=false;m.onTransitionComplete.call(m);if(m._changeHash){m._setGrabCursor()}if(m.settings.autoOpenDescription&&m.sliderWidth>900){if(!m._collapsedSlider){if(m.currItemId===0&&!m.albumsArr[m.currAlbumId].data("sawInfo")){m._showAlbumInfo();m.albumsArr[m.currAlbumId].data("sawInfo",true)}else{m._fadeIn(m._albumIndicator)}}}else{m._fadeIn(m._albumIndicator)}},30)}var d={};if(isNaN(m._currAnimSpeed)){m._currAnimSpeed=400}if(!m._useCSS3Transitions){d[h]=l;m._dragContainer.animate(d,m._currAnimSpeed,k?m.settings.easeInOutEasing:"easeOutSine")}else{d[(m.browserSufix+"transition-duration")]=m._currAnimSpeed+"ms";d[(m.browserSufix+"transition-property")]=(m.browserSufix+"transform");d[(m.browserSufix+"transition-timing-function")]=((k!=undefined)?m.settings.css3easeInOutEasing:"cubic-bezier(0.390, 0.575, 0.565, 1.000)");m._dragContainer.css(d);m._dragContainer.css(h,m._tPref1+m.x+m._tPref2+m.y+m._tPref3)}if(g){m.loadingTimeout=setTimeout(function(){g.call()},m._currAnimSpeed+50)}else{m.loadingTimeout=setTimeout(function(){j()},m._currAnimSpeed+50)}},_setPosition:function(e,d){var c=this;if(c._useCSS3Transitions){if(d==="y"){c.y=e;c._dragContainer.css(c._yProp,c._tPref1+c.x+c._tPref2+c.y+c._tPref3)}else{c.x=e;c._dragContainer.css(c._xProp,c._tPref1+c.x+c._tPref2+c.y+c._tPref3)}}else{if(d==="y"){c.y=e;c._dragContainer.css(c._yProp,c.y)}else{c.x=e;c._dragContainer.css(c._xProp,c.x)}}},updateSliderSize:function(){var m=this,f=window.innerWidth||document.body.clientWidth,g=window.innerHeight||document.body.clientHeight,l=m._slidesWrapper.width(),k=m._slidesWrapper.height();if(l!=m.sliderWidth||k!=m.sliderHeight){m.sliderWidth=l;m.sliderHeight=k;m._xDistToSnap=1;m._yDistToSnap=1;if(m.sliderWidth<600){m._collapsedSlider=true;m.sliderRoot.addClass("smaller-collapsed-slider")}else{m._collapsedSlider=false;m.sliderRoot.removeClass("smaller-collapsed-slider")}if(f>=850){m._imagePaddingEMs="2";if(!m._controlsVisible){m._showAllControls()}}else{if(f<850){if(f>700){m._imagePaddingEMs="1"}else{m._imagePaddingEMs="0"}}}if(m._useCSS3Transitions){m._dragContainer.css((m.browserSufix+"transition-duration"),"0s")}var c=[m._centerBlock,m._leftBlock,m._rightBlock,m._bottomBlock,m._topBlock];var j;var d;for(var h=0;h<c.length;h++){j=c[h].find("img");if(j){m._resizeImage(j,j.data("img-width"),j.data("img-height"))}}m._setPosition(m._currentMainBlockId*m.sliderWidth,"x");m._setPosition(m._currentMainAlbumBlockId*m.sliderHeight,"y");if(m.isVideoPlaying){var e=m.videoContainer.find(".video-player"),n=m._resizeImage("",m.settings.maxVideoWidth,m.settings.maxVideoHeight,true);e.css({"margin-left":n.left,"margin-top":n.top,width:n.width,height:n.height});e.removeAttr("width")}}},updateContents:function(){var f=this,c=f.currAlbumItems.eq(f.currItemId),e=[];f._addItemToLoadQueue(e,f._centerBlock,f.currAlbumId,f.currItemId);f._addItemToLoadQueue(e,f._rightBlock,f.currAlbumId,f.currItemId+1);f._addItemToLoadQueue(e,f._leftBlock,f.currAlbumId,f.currItemId-1);f._addItemToLoadQueue(e,f._bottomBlock,f.currAlbumId+1,0);f._addItemToLoadQueue(e,f._topBlock,f.currAlbumId-1,0);f._updateImageQueue(e);var d=f._getAlbum(f.currAlbumId);d.data("start-item",f.currItemId);f._updateControls()},_getItem:function(f,j){var e=this,h;if(f<0){if(!e._loopAlbums){return false}f=e.numAlbums-1}else{if(f>=this.numAlbums){if(!e._loopAlbums){return false}f=0}}var c=this.albumsArr[f];if(c){var d=c.find(".two-dim-item");if(d){var g=d.length;if(g<=0){return 0}if(j<0){if(!e._loopItems){return false}j=g-1}else{if(j>=g){if(!e._loopItems){return false}j=0}}h=d.eq(j)}h.find("img").data("img-scale",c.data("img-scale"))}return h},_updateCurrItemId:function(f,h){var e=this;e._lastAlbumId=e.currAlbumId;e._lastAlbumNumItems=e.currAlbumNumItems;e._lastItemId=e.currItemId;if(f<0){f=e.numAlbums-1}else{if(f>=e.numAlbums){f=0}}e.currAlbumId=f;var c=e.albumsArr[f];if(c){var d=c.find(".two-dim-item");if(d){var g=d.length;if(g<=0){return 0}e.currAlbumNumItems=g;if(h<0){h=g-1}else{if(h>=g){h=0}}}e.currItemId=h}else{alert("Album is empty:"+f+" id:"+h)}},_updateControls:function(f){var e=this;function d(){e._itemCountIndicator.text(""+(e.currItemId+1)+" of "+e.currAlbumNumItems)}if(f==="y"){if(e.numAlbums>1){if(e.currAlbumId>=0){if(e.settings.appendGalleriesToMenu){e._galleryMenuItems.removeClass("current-album-menu-item");e._galleryMenuItems.eq(e.currAlbumId).addClass("current-album-menu-item")}if(!e._collapsedSlider){e._fadeOut(e._albumIndicator)}setTimeout(function(){e._itemCountIndicator.text(""+(e.currItemId+1)+" of "+e.currAlbumNumItems);e._albumNameIndicator.text(e.albumsArr[e.currAlbumId].find(".album-title").text())},400);e._updateAlbumIndicator();e._updateItemControls()}}}else{if(f==="x"){d();e._updateItemControls()}else{if(e._galleryMenuItems){var c=e._galleryMenuItems.eq(e.currAlbumId);c.addClass("current-album-menu-item")}e._updateAlbumIndicator();e._albumNameIndicator.text(e.albumsArr[e.currAlbumId].find(".album-title").text());d();e._updateItemControls()}}},_updateItemControls:function(){var c=this;if(c._arrowControlsEnabled){if(c._prevImageArr.hasClass("disabled-arrow")){c._prevImageArr.removeClass("disabled-arrow")}if(c._nextImageArr.hasClass("disabled-arrow")){c._nextImageArr.removeClass("disabled-arrow")}if(c.currItemId<=0){if(c.currAlbumId>0){if(!c._prevImageArr.hasClass("prev-album-arrow")){c._prevImageArr.addClass("prev-album-arrow").find(".info-text").addClass("info-text-visible")}}else{if(c._lastItemLink&&c._galleryPostsNavigation.find("a[rel=next]").attr("href")){c._prevImageArr.addClass("prev-album-arrow").find(".info-text").addClass("info-text-visible")}else{c._prevImageArr.addClass("disabled-arrow").find(".info-text").removeClass("info-text-visible")}}}else{if(c._prevImageArr.hasClass("prev-album-arrow")){c._prevImageArr.removeClass("prev-album-arrow").find(".info-text").removeClass("info-text-visible")}}if(c.currItemId>=c.currAlbumNumItems-1){if(c.currAlbumId<c.numAlbums-1){if(!c._nextImageArr.hasClass("next-album-arrow")){c._nextImageArr.addClass("next-album-arrow").find(".info-text").addClass("info-text-visible")}}else{if(c._lastItemLink&&c._galleryPostsNavigation.find("a[rel=prev]").attr("href")){c._nextImageArr.addClass("next-album-arrow").find(".info-text").addClass("info-text-visible")}else{c._nextImageArr.addClass("disabled-arrow").find(".info-text").removeClass("info-text-visible")}}}else{if(c._nextImageArr.hasClass("next-album-arrow")){c._nextImageArr.removeClass("next-album-arrow").find(".info-text").removeClass("info-text-visible")}}}},_updateAlbumIndicator:function(){},_getAlbum:function(c){if(c<0){c=this.numAlbums-1}else{if(c>=this.numAlbums){c=0}}return this.albumsArr[c]},_updateImageQueue:function(g){var k=this;if(g){var c,h,d,j,e,l;for(var f=0;f<g.length;f++){c=g[f];j=c.block;l=c.item.data();if(c.item){h=j.find("img");e=Boolean(l.videoUrl!==undefined);if(!e){j.find(".play-button-container").remove()}d=c.item.find("a").attr("href");if(h.attr("src")!==d){h.css("visibility","hidden")}else{if(!c.block.hasClass("loading")){h.css("visibility","visible")}}k._updateAlbumBackground(j,c.bgColor,c.albumId)}else{g.splice(f,1);f--}}k.isLoading=true}k.loadQueue=g;k._loadNextImage(true)},_onLoadingComplete:function(c){var d=this;return function(){var h=c.img,e=c.loadDataItem.item.data(),g=c.block.find(".block-inside"),f=Boolean(e.videoUrl!==undefined);if(!h.data("blocked-by-loop")){h.css({visibility:"visible"})}if(f){if(!g.find(".play-button-container").length>0){g.append('<a class="play-button-container"><span class="play-button"><i class="play-icons-wrap"><u class="play-button-icon"></u><u class="play-video-loading-icon"></u></i></snan></a>');g.find(".play-button-container").bind("click",function(j){if(!d.moved){j.preventDefault();j.stopImmediatePropagation();d._controlsVisible=true;d._showVideo(c,g)}else{return false}})}}else{if(g.find(".play-button-container").length>0){g.find("img").css("cursor","inherit").unbind("click");g.find(".play-button-container").unbind("click");g.find(".play-button-container").remove()}}c.block.removeClass("loading");c.block.find(".preloader-container").remove();h.unbind("error.tds");h.unbind("load.tds");if(!d.firstLoaded&&d.settings.firstImageLoadedCallback){d.settings.firstImageLoadedCallback.call(d);d.firstLoaded=true}if(d.loadQueue.length>1){d.loadQueue.shift();d._loadNextImage()}else{d.isLoading=false}}},_loadNextImage:function(d){var l=this;var h=l.loadQueue[0];if(!h){return}var c=h.item;if(c){var j=h.block,f=j.find("img").eq(0),k=b("#img-desc").eq(0),n=c.find("a").attr("href"),m=c.attr("data-img-width"),e=c.attr("data-img-height"),g=c.attr("data-img-desc");if(f.length<=0){hasImage=false;f=b("<img />");currBlockPath=""}else{hasImage=true;currBlockPath=f.attr("src")}if(k.length<=0){hasDesc=false;k=b('<div id="img-desc" class="img-desc-block text-block"><div class="info-container"><div class="img-content">'+g+"</div></div></div>")}else{hasDesc=true}f.data({"img-width":m,"img-height":e,"img-scale":c.data("img-scale")});if(d){if(g.length>0){k.find(".img-content").text(g);k.show()}else{k.hide()}}if(currBlockPath===n){if(!j.hasClass("loading")){if(l.loadQueue.length>1){l.loadQueue.shift();l._loadNextImage()}else{l.isLoading=false}}return}if(!l.imageLoader||l.imageLoader.attr("src")!=n){j.addClass("loading");j.append('<div class="preloader-container"><div class="preloader-spinner"></div></div>');f.css("visibility","hidden").bind("load.tds",l._onLoadingComplete({type:"loaded",loadDataItem:h,block:j,img:f})).bind("error.tds",l._onLoadingComplete({type:"error",loadDataItem:h,block:j,img:f})).attr({src:n,alt:c.find("a").text()});if(!hasDesc){k.appendTo(b("#main-slider"))}if(!hasImage){f.appendTo(j.find(".block-inside"))}l._resizeImage(f,m,e)}else{l._resizeImage(f,m,e);l._onLoadingComplete({type:"loaded",item:c,block:j})}}},_resizeImage:function(j,k,d,c){var r=this;imgScaleMode=!c?j.data("img-scale"):"fit-if-smaller";if(!c){k=parseInt(k,10);d=parseInt(d,10)}if(!c){var o;if(imgScaleMode!=="fill"){o=r._imagePaddingEMs+"em"}else{o="0"}var g=j.parent(".block-inside").css("margin",o);r.imgWrapWidth=g.width();r.imgWrapHeight=g.height()}else{r.imgWrapWidth=r.videoContainer.width();r.imgWrapHeight=r.videoContainer.height()}var h=0,q=r.imgWrapWidth,s=r.imgWrapHeight,e=true,f,l,n,m,p;if(imgScaleMode==="fit-if-smaller"){if(k>q||d>s){imgScaleMode="fit"}}if(imgScaleMode==="fill"||imgScaleMode==="fit"){f=q/k;l=s/d;if(imgScaleMode=="fill"){n=f>l?f:l}else{if(imgScaleMode=="fit"){n=f<l?f:l}else{n=1}}m=parseInt(k*n,10);p=parseInt(d*n,10)}else{m=k;p=d}if(e){if(j){j.css({"margin-left":Math.floor((q-m)/2),"margin-top":Math.floor((s-p)/2),width:m,height:p})}else{return{width:m,height:p,left:Math.floor((q-m)/2),top:Math.floor((s-p)/2)}}}else{if(j){j.css({width:m,height:p})}else{return{width:m,height:p,left:0,top:0}}}},_setGrabCursor:function(){if(!this.hasTouch){if(this._grabCursor){this._slidesWrapper.css("cursor",this._grabCursor)}else{this._slidesWrapper.removeClass("grabbing-cursor");this._slidesWrapper.addClass("grab-cursor")}}},_setGrabbingCursor:function(){if(!this.hasTouch){if(this._grabbingCursor){this._slidesWrapper.css("cursor",this._grabbingCursor)}else{this._slidesWrapper.removeClass("grab-cursor");this._slidesWrapper.addClass("grabbing-cursor")}}},_showVideo:function(g,k){var e=this;if(e.isVideoPlaying){return false}var c=g.loadDataItem.item.data();if(c.videoUrl!==undefined){var j=c.videoUrl,h;if(j.match(/youtu\.be/i)||j.match(/youtube\.com\/watch/i)){h=e._getYoutubeVideoId(j);if(h){e.isVideoPlaying=true;j="http://www.youtube.com/embed/"+h+"?rel=1";if(e.settings.autoplayVideo){j+="&autoplay=1&showinfo=0"}k.find(".play-button").addClass("play-button-loading");e._fadeInVideo(g.loadDataItem.block);var d=b('<iframe class="video-player" src ="'+j+'" frameborder="no"></iframe>');e.videoOverlay.css("display","block");var f=e._resizeImage("",e.settings.maxVideoWidth,e.settings.maxVideoHeight,true);d.css({"margin-left":f.left,"margin-top":f.top,width:f.width,height:f.height});e._videoCloseButton.removeClass("hidden-video");e.videoContainer.append(d)}else{alert("Incorrect YouTube URL syntax")}}else{if(j.match(/vimeo\.com/i)){h=e._getVimeoVideoId(j);e.isVideoPlaying=true;j="http://player.vimeo.com/video/"+h+"?title=0&amp;byline=0&amp;portrait=0";if(e.settings.autoplayVideo){j+="&autoplay=1"}k.find(".play-button").addClass("play-button-loading");e._fadeInVideo(g.loadDataItem.block);var d=b('<iframe class="video-player" src ="'+j+'" frameborder="no"></iframe>');e.videoOverlay.css("display","block");var f=e._resizeImage("",e.settings.maxVideoWidth,e.settings.maxVideoHeight,true);d.css({"margin-left":f.left,"margin-top":f.top,width:f.width,height:f.height});e._videoCloseButton.removeClass("hidden-video");e.videoContainer.append(d)}else{alert("Incorrect video URL: "+j)}}}},stopAndCloseVideo:function(){var d=this;d._videoCloseButton.addClass("hidden-video");d.videoOverlay.css("display","none");d.videoContainer.find("iframe").remove();var c=d._centerBlock.find("img");if(c.length>0){c.animate({opacity:1},400,"easeOutSine")}d._centerBlock.find(".play-button-loading").removeClass("play-button-loading");d.isVideoPlaying=false;d._showAllControls()},_fadeInVideo:function(e){var d=this;if(d._albumInfoOpen){d._toggleAlbumInfo()}var c=e.find("img");if(c.length>0){c.animate({opacity:0},400,"easeOutSine")}d._hideAllControls()},_showAllControls:function(){var c=this;if(!c._controlsVisible){c._fadeIn(c._headerSideMenu);c._controlsVisible=true;c._fadeIn(c._sliderControls)}},_hideAllControls:function(){var c=this;if(c._controlsVisible){if(c._albumInfoOpen){c._toggleAlbumInfo()}if(c._headerSideMenu.hasClass("collapsed-gallery-page-menu")){c._fadeOut(c._headerSideMenu)}c._fadeOut(c._sliderControls);c._controlsVisible=false}},_fadeOut:function(d,c){setTimeout(function(){d.stop().animate({opacity:0},300,function(){d.css("display","none");if(c){c.call()}})},0)},_fadeIn:function(d,c){d.stop().css("display","block");setTimeout(function(){d.animate({opacity:1},300,function(){if(c){c.call()}})},0)},_getVimeoVideoId:function(e){var d=/\/\/(www\.)?vimeo.com\/(\d+)($|\/)/;var c=e.match(d);if(c){return c[2]}else{return false}},_getYoutubeVideoId:function(e){var d=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/;var c=e.match(d);if(c&&c[7].length==11){return c[7]}else{return false}},_showAlbumInfo:function(){var k=this,l;if(!k._albumInfoOpen){if(k._albumInfoBlock.data("curr-album-id")!==k.currAlbumId){var g=k.albumsArr[k.currAlbumId].find(".album-meta");var e='<div class="info-container">'+g.html();var j=g.find(".album-title a");var c=j.attr("href");j=j.html();var f=k._getItem(k.currAlbumId,0).find("a").attr("href");e+='<div class="bottom-bar clearfix">';if(k.settings.showShareButtons){e+='<div class="share-project">';e+='<a href="http://pinterest.com/pin/create/button/?url='+c+"&media="+f+"&description="+j+'" class="pin-it-btn"></a>';e+='<a class="facebook-share-btn" href="http://www.facebook.com/sharer/sharer.php?u='+c+'">';e+="</a>"}e+='<a href="javascript:void(0);" class="close-project">'+k._wpVars.closeProjectInfo+"</a>";e+="</div>";e+="</div>";k._albumInfoBlock.html(e);var d=k._albumInfoBlock.find(".album-title a");d.replaceWith(d.text());var h=k._albumInfoBlock.find(".close-project");h.bind("click",function(m){m.preventDefault();k._hideAlbumInfo()});k._albumInfoBlock.find(".pin-it-btn, .facebook-share-btn").click(function(n){n.preventDefault();var m=window.open(b(this).attr("href"),"signin","width=665,height=300")});if(typeof(FB)!="undefined"&&FB!=null){FB.XFBML.parse(k._albumInfoBlock.get(0))}k._albumInfoBlock.data("curr-album-id",k.currAlbumId)}k._fadeIn(k._albumInfoBlock);k._fadeOut(k._albumIndicator);k._albumInfoOpen=true}},_hideAlbumInfo:function(){var c=this;if(c._albumInfoOpen){c._albumInfoAnimating=true;c._fadeOut(c._albumInfoBlock,function(){c._albumInfoAnimating=false});c._fadeIn(c._albumIndicator);c._albumInfoOpen=false}},_toggleAlbumInfo:function(){var c=this,d;if(c._albumInfoOpen){c._hideAlbumInfo()}else{c._showAlbumInfo()}},_updateMenuSize:function(){var d=this,c=window.innerWidth||document.body.clientWidth;if(d._isMenuVisible){d._isMenuCollapsed=true;if(c>600){d._headerSideMenu.css("width","50%")}else{d._headerSideMenu.css("width","100%")}}},_getQueryParameters:function(){var f=window.location.href.split("?")[1];if(!f){return{}}var h=f.split("&");var e={};for(var d=0,c=h.length;d<c;d++){var g=h[d].split("=");e[g[0]]=g[1]}return e}};b.fn.twoDimSlider=function(c){return this.each(function(){var d=new a(b(this),c);b(this).data("twoDimSlider",d)})};b.fn.twoDimSlider.defaults={keyboardNavEnabled:true,transitionSpeed:600,autoplayVideo:true,maxVideoWidth:800,maxVideoHeight:600,openInfoBlockAtStart:false,disableContextMenu:false,easeInOutEasing:"easeInOutSine",css3easeInOutEasing:"cubic-bezier(0.445, 0.050, 0.550, 0.950)",firstImageLoadedCallback:false,appendGalleriesToMenu:false,autoOpenDescription:Boolean(tdSliderVars.autoOpenProjectDesc),showShareButtons:Boolean(tdSliderVars.showShareButtons)};b.fn.twoDimSlider.settings={}})(jQuery);

/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 *
 * Requires: 1.2.2+
 */
(function($){var c=['DOMMouseScroll','mousewheel'];if($.event.fixHooks){for(var i=c.length;i;){$.event.fixHooks[c[--i]]=$.event.mouseHooks}}$.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var i=c.length;i;){this.addEventListener(c[--i],handler,false)}}else{this.onmousewheel=handler}},teardown:function(){if(this.removeEventListener){for(var i=c.length;i;){this.removeEventListener(c[--i],handler,false)}}else{this.onmousewheel=null}}};$.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}});function handler(a){var b=a||window.event,args=[].slice.call(arguments,1),delta=0,returnValue=true,deltaX=0,deltaY=0;a=$.event.fix(b);a.type="mousewheel";if(b.wheelDelta){delta=b.wheelDelta/120}if(b.detail){delta=-b.detail/3}deltaY=delta;if(b.axis!==undefined&&b.axis===b.HORIZONTAL_AXIS){deltaY=0;deltaX=-1*delta}if(b.wheelDeltaY!==undefined){deltaY=b.wheelDeltaY/120}if(b.wheelDeltaX!==undefined){deltaX=-1*b.wheelDeltaX/120}args.unshift(a,delta,deltaX,deltaY);return($.event.dispatch||$.event.handle).apply(this,args)}})(jQuery);



/* Modernizr 2.5.2 (Custom Build) | MIT & BSD
 * Build: http://www.modernizr.com/download/#-csstransforms3d-teststyles-testprop-testallprops-prefixes-domprefixes
 */
;window.Modernizr=function(a,b,c){function y(a){i.cssText=a}function z(a,b){return y(l.join(a+";")+(b||""))}function A(a,b){return typeof a===b}function B(a,b){return!!~(""+a).indexOf(b)}function C(a,b){for(var d in a)if(i[a[d]]!==c)return b=="pfx"?a[d]:!0;return!1}function D(a,b,d){for(var e in a){var f=b[a[e]];if(f!==c)return d===!1?a[e]:A(f,"function")?f.bind(d||b):f}return!1}function E(a,b,c){var d=a.charAt(0).toUpperCase()+a.substr(1),e=(a+" "+n.join(d+" ")+d).split(" ");return A(b,"string")||A(b,"undefined")?C(e,b):(e=(a+" "+o.join(d+" ")+d).split(" "),D(e,b,c))}var d="2.5.2",e={},f=b.documentElement,g="modernizr",h=b.createElement(g),i=h.style,j,k={}.toString,l=" -webkit- -moz- -o- -ms- ".split(" "),m="Webkit Moz O ms",n=m.split(" "),o=m.toLowerCase().split(" "),p={},q={},r={},s=[],t=s.slice,u,v=function(a,c,d,e){var h,i,j,k=b.createElement("div"),l=b.body,m=l?l:b.createElement("body");if(parseInt(d,10))while(d--)j=b.createElement("div"),j.id=e?e[d]:g+(d+1),k.appendChild(j);return h=["&#173;","<style>",a,"</style>"].join(""),k.id=g,m.innerHTML+=h,m.appendChild(k),l||f.appendChild(m),i=c(k,a),l?k.parentNode.removeChild(k):m.parentNode.removeChild(m),!!i},w={}.hasOwnProperty,x;!A(w,"undefined")&&!A(w.call,"undefined")?x=function(a,b){return w.call(a,b)}:x=function(a,b){return b in a&&A(a.constructor.prototype[b],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if(typeof c!="function")throw new TypeError;var d=t.call(arguments,1),e=function(){if(this instanceof e){var a=function(){};a.prototype=c.prototype;var f=new a,g=c.apply(f,d.concat(t.call(arguments)));return Object(g)===g?g:f}return c.apply(b,d.concat(t.call(arguments)))};return e});var F=function(a,c){var d=a.join(""),f=c.length;v(d,function(a,c){var d=b.styleSheets[b.styleSheets.length-1],g=d?d.cssRules&&d.cssRules[0]?d.cssRules[0].cssText:d.cssText||"":"",h=a.childNodes,i={};while(f--)i[h[f].id]=h[f];e.csstransforms3d=(i.csstransforms3d&&i.csstransforms3d.offsetLeft)===9&&i.csstransforms3d.offsetHeight===3},f,c)}([,["@media (",l.join("transform-3d),("),g,")","{#csstransforms3d{left:9px;position:absolute;height:3px;}}"].join("")],[,"csstransforms3d"]);p.csstransforms3d=function(){var a=!!E("perspective");return a&&"webkitPerspective"in f.style&&(a=e.csstransforms3d),a};for(var G in p)x(p,G)&&(u=G.toLowerCase(),e[u]=p[G](),s.push((e[u]?"":"no-")+u));return y(""),h=j=null,e._version=d,e._prefixes=l,e._domPrefixes=o,e._cssomPrefixes=n,e.testProp=function(a){return C([a])},e.testAllProps=E,e.testStyles=v,e}(this,this.document);


/*!
 * jQuery idleTimer plugin
 * version 0.9.100511
 * by Paul Irish.
 *   http://github.com/paulirish/yui-misc/tree/
 * MIT license
 * Copyright (c) 2009 Nicholas C. Zakas
 * adapted from YUI idle timer by nzakas:
 *   http://github.com/nzakas/yui-misc/
*/
(function(e){e.idleTimer=function(t,n,r){r=e.extend({startImmediately:true,idle:false,enabled:true,timeout:3e4,events:"mousemove keydown DOMMouseScroll mousewheel mousedown touchstart touchmove"},r);n=n||document;var i=function(t){if(typeof t==="number"){t=undefined}var s=e.data(t||n,"idleTimerObj");s.idle=!s.idle;var o=+(new Date)-s.olddate;s.olddate=+(new Date);if(s.idle&&o<r.timeout){s.idle=false;clearTimeout(e.idleTimer.tId);if(r.enabled)e.idleTimer.tId=setTimeout(i,r.timeout);return}var u=jQuery.Event(e.data(n,"idleTimer",s.idle?"idle":"active")+".idleTimer");e(n).trigger(u)},s=function(t){var n=e.data(t,"idleTimerObj")||{};n.enabled=false;clearTimeout(n.tId);e(t).off(".idleTimer")},o=function(t){var n=e.data(this,"idleTimerObj");clearTimeout(n.tId);if(n.enabled){if(n.idle){i(this)}n.tId=setTimeout(i,n.timeout)}};var u=e.data(n,"idleTimerObj")||{};u.olddate=u.olddate||+(new Date);if(typeof t==="number"){r.timeout=t}else if(t==="destroy"){s(n);return this}else if(t==="getElapsedTime"){return+(new Date)-u.olddate}e(n).on(e.trim((r.events+" ").split(" ").join(".idleTimer ")),o);u.idle=r.idle;u.enabled=r.enabled;u.timeout=r.timeout;if(r.startImmediately){u.tId=setTimeout(i,u.timeout)}e.data(n,"idleTimer","active");e.data(n,"idleTimerObj",u)};e.fn.idleTimer=function(t,n){if(!n){n={}}if(this[0]){e.idleTimer(t,this[0],n)}return this}})(jQuery);
